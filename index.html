<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Hello</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Bilberry Blog, hexo blog">
<meta property="og:type" content="website">
<meta property="og:title" content="Hello">
<meta property="og:url" content="http://xydida.com/index.html">
<meta property="og:site_name" content="Hello">
<meta property="og:description" content="Bilberry Blog, hexo blog">
<meta property="og:locale" content="zh">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hello">
<meta name="twitter:description" content="Bilberry Blog, hexo blog">
  
    <link rel="alternate" href="/atom.xml" title="Hello" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hello</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">能找到我的也不是等闲之辈</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://xydida.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-The-measureText-function-in-Wechat-miniprogram-canvas" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/9/14/小程序/The-measureText-function-in-Wechat-miniprogram-canvas/" class="article-date">
  <time datetime="2018-09-14T14:48:10.000Z" itemprop="datePublished">2018-09-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/小程序/">小程序</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/9/14/小程序/The-measureText-function-in-Wechat-miniprogram-canvas/">在小程序Canvas中使用measureText</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>有时候我们在使用Canvas绘制一段文本时，会需要通过<code>measureText()</code>方法获取文本的宽度，例如：</p>
<h3 id="创建canvas标签"><a href="#创建canvas标签" class="headerlink" title="创建canvas标签"></a>创建canvas标签</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;canvas id=&quot;canvas&quot;&gt;&lt;/canvas&gt;</span><br></pre></td></tr></table></figure>
<h3 id="获取一段文本的宽度"><a href="#获取一段文本的宽度" class="headerlink" title="获取一段文本的宽度"></a>获取一段文本的宽度</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var canvas = document.getElementById(&apos;canvas&apos;);</span><br><span class="line">var ctx = canvas.getContext(&apos;2d&apos;);</span><br><span class="line"></span><br><span class="line">var text = ctx.measureText(&apos;foo&apos;); // TextMetrics object</span><br><span class="line">text.width; // 16;</span><br></pre></td></tr></table></figure>
<p>如上所示，<code>measureText</code>返回的其实是一个<code>TextMetrics</code>对象，它包含了文本的宽度，<a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/measureText" target="_blank" rel="noopener">MDN</a>上的解释如下：</p>
<blockquote>
<p>The CanvasRenderingContext2D.measureText() method returns a TextMetrics object that contains information about the measured text (such as its width for example).</p>
</blockquote>
<p>在微信小程序现在的版本（v2.13.7）中，小程序的canvas还不支持<code>measureText</code>，所以我自己写了个类似于<code>measureText</code>方法，<strong>通过canvas获取文本的宽度</strong>，方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">function measureText (text, fontSize=10) &#123;</span><br><span class="line">    text = String(text);</span><br><span class="line">    var text = text.split(&apos;&apos;);</span><br><span class="line">    var width = 0;</span><br><span class="line">    text.forEach(function(item) &#123;</span><br><span class="line">        if (/[a-zA-Z]/.test(item)) &#123;</span><br><span class="line">            width += 7;</span><br><span class="line">        &#125; else if (/[0-9]/.test(item)) &#123;</span><br><span class="line">            width += 5.5;</span><br><span class="line">        &#125; else if (/\./.test(item)) &#123;</span><br><span class="line">            width += 2.7;</span><br><span class="line">        &#125; else if (/-/.test(item)) &#123;</span><br><span class="line">            width += 3.25;</span><br><span class="line">        &#125; else if (/[\u4e00-\u9fa5]/.test(item)) &#123;  //中文匹配</span><br><span class="line">            width += 10;</span><br><span class="line">        &#125; else if (/\(|\)/.test(item)) &#123;</span><br><span class="line">            width += 3.73;</span><br><span class="line">        &#125; else if (/\s/.test(item)) &#123;</span><br><span class="line">            width += 2.5;</span><br><span class="line">        &#125; else if (/%/.test(item)) &#123;</span><br><span class="line">            width += 8;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            width += 10;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    return width * fontSize / 10;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xydida.com/2018/9/14/小程序/The-measureText-function-in-Wechat-miniprogram-canvas/" data-id="cjm257nvm0007289k3ydrz4rj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/">canvas</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/小程序/">小程序</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-WeChat-miniprogram-data-analysis-custom-analysis" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/8/15/小程序/WeChat-miniprogram-data-analysis-custom-analysis/" class="article-date">
  <time datetime="2018-08-15T14:16:31.000Z" itemprop="datePublished">2018-08-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/小程序/">小程序</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/8/15/小程序/WeChat-miniprogram-data-analysis-custom-analysis/">微信小程序数据分析之自定义分析</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在小程序后台，微信已经提供了强大的数据分析功能，包括实时统计、访问分析、来源分析和用户画像功能，可以说对一般的数据分析已经完全足够了，但有时应用需要做一些更加精准的数据分析，比如具体到某一个页面的分享，页面中某一个button的点击等，这时候就需要用到自定义分析功能。</p>
<h3 id="什么是自定义分析？"><a href="#什么是自定义分析？" class="headerlink" title="什么是自定义分析？"></a>什么是自定义分析？</h3><p>引用下官方文档：</p>
<blockquote>
<p>自定义分析支持灵活多维和近实时的用户行为分析，可以通过自定义上报，对用户在小程序内的行为做精细化跟踪，满足页面访问等标准统计以外的个性化分析需求。</p>
</blockquote>
<h3 id="创建自定义事件"><a href="#创建自定义事件" class="headerlink" title="创建自定义事件"></a>创建自定义事件</h3><p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fuarhk0wg3j310t0r741g.jpg" alt="进入自定义事件页面"></p>
<ul>
<li>事件英文名称和事件中文名称按照说明要求填写，这两个名称都是唯一的，不能设置成已经设置过的，而且设置的时候尽量简洁、还要见名知意</li>
<li>配置方式有：填写配置、API上报。</li>
<li>配置模版：官方已经提供了一些自定义事件模版，直接使用就可以，包括有：进入页面、离开页面、小程序内分享，不过这些事件的分析粒度都比较粗，针对整个应用，可以自己修改只针对某一页</li>
<li>填写配置的方式支持以下几种统计触发器，有：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">click 点击时触发</span><br><span class="line">enterPage 进入页面时触发，包括新开、后退、切换到前台都属于进入页面</span><br><span class="line">leavePage 离开页面时触发，包括离开、切换到后台都属于离开页面</span><br><span class="line">pageLoad 新开页面时触发，即第一次进入页面</span><br><span class="line">pageUnload 回收页面时触发</span><br><span class="line">pullDownRefresh 下拉刷新时触发</span><br><span class="line">launch 加载小程序时触发</span><br><span class="line">background 切换到后台触发</span><br><span class="line">foreground 切换到前台触发</span><br><span class="line">share 右上角菜单分享</span><br><span class="line">switchTab 调用switchTab接口切换页面时触发</span><br></pre></td></tr></table></figure>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fuas1d6p2aj31050rjdib.jpg" alt="配置信息"></p>
<ul>
<li>action指出发时的动作，一次性上报，表示在每一次 click 中，收集数据并上报一条数据；分步骤上报我也还没搞懂 😅</li>
<li>page指要触发该事件的页面，这里填写的内容必须要和<code>app.json</code>中配置的页面路径一样</li>
<li>data是选填的，是用来给事件触发时传递一些数据的，其中，字段值就是当前page的<code>data</code>中的数据名称</li>
</ul>
<h4 id="举个例子🌰"><a href="#举个例子🌰" class="headerlink" title="举个例子🌰"></a>举个例子🌰</h4><p>电商类小程序中，用户会有一个点击商品添加到购物车的动作，我们可以对这个动作进行数据分析，以下是<code>填写配置</code>的方式：</p>
<ol>
<li>填写事件英文和中文名称：</li>
</ol>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fuashtxxsxj30o008igml.jpg" alt="填写事件英文和中文名称"></p>
<ol start="2">
<li>填写事件配置，定义如何收集数据：</li>
</ol>
<p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fuasijuqzdj30wh0o9myn.jpg" alt="填写事件配置"></p>
<p>这个例子中，用一个动作上报“加入购物车”事件。</p>
<ul>
<li>trigger：触发条件，click，表示点击操作触发；</li>
<li>action：触发时动作，一次性上报，表示在每一次 click 中，收集数据并上报一条数据；</li>
<li>page：触发页面，填 viewProduct（viewProduct 是商品详情页）；</li>
<li>element：触发元素，填 .addToCart（.addToCart 是一个“加入购物车”的按钮）；</li>
<li>data：事件的数据及其来源，用“字段名 字段值”来表示，其中字段值是页面上的一个变量。</li>
</ul>
<p>详细说一下字段值，他有如下规则：</p>
<ul>
<li>填写的变量名，默认从page实例的data字段中获取</li>
<li>若想收集由list变量渲染的列表中的某一项数据，则可用list[].*表示，这里会根据当前填写的element（只能是class）得到的NodeList的第几个来决定数组下标。</li>
<li>若列表是二维的，则可用list[][].*表示，这里element需填写两个class（空格隔开）分别表示父列表与子列表。</li>
<li>若想取得数组的下标，则可用list[].$INDEX表示</li>
<li>若想取得wxml中data-<em>系列属性的值，则可用$DATASET.</em>表示</li>
<li>若想取得app实例的数据，则可用$APP.*表示，只支持获取基本类型的数据，如number、string、boolean。</li>
</ul>
<p>除此之外，还可以填写一些提供的系统属性，以“$”开头，目前支持以下属性：</p>
<ul>
<li><code>$PAGE_TIME</code> 用户从进入本页面到当前的时间(触发action的时间点)</li>
<li><code>$APP_TIME</code> 用户进入小程序到当前的时间(触发action的时间点)</li>
<li><code>$CURRENT_PAGE</code> 当前用户所在的页面</li>
<li><code>$LAST_PAGE</code> 上一页</li>
</ul>
<blockquote>
<p>注：data可以为空，为空时该事件上报仅收集系统默认字段的数据</p>
</blockquote>
<p>这个例子中，data有四项：</p>
<p>product_id: itemID</p>
<p>product_name: itemName</p>
<p>product_price: price</p>
<p>product_category: category</p>
<p>即：</p>
<p>事件的product_id字段，收集viewProduct页面上page实例的data中的itemID字段；</p>
<p>事件的product_name字段，收集viewProduct页面上page实例的data中的itemName字段；</p>
<p>事件的product_price字段，收集viewProduct页面上page实例的data中的price字段；</p>
<p>事件的product_category字段，收集viewProduct页面上page实例的data中的category字段；</p>
<p>以上内容表示：当用户点击 viewProduct 页面上的 .addToCart 按钮时，上报一条记录到 add_to_cart 事件，事件的 product_id, product_name, product_price, product_category 字段， 取值分别是页面上的 itemID, itemName, price, category。</p>
<p>填写完配置后，还要点击<code>检查字段</code>。</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNbRwgy1fuaslz88fdj30o00dr0tm.jpg" alt=""></p>
<p>此时会提示 add_to_cart 事件包含的具体字段，继续补充字段的名称、数据类型和备注信息。</p>
<h4 id="关于API上报"><a href="#关于API上报" class="headerlink" title="关于API上报"></a>关于API上报</h4><p>API上报比填写配置的方式更加灵活，但这也涉及到一些代码的更改，需要发布新版本，而填写配置的方式几乎不需要更改代码，所以无需发布新版本。当我们选择<code>API上报</code>后，我们可以设置需要上报的一下参数：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fuat0h1b9zj30x50dh3zb.jpg" alt="API上报"></p>
<p>点击生成代码：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fuat1kc176j30wl0hrwfs.jpg" alt=""></p>
<p>时间创建完成后，点击保存，后台就生成了一条事件记录，并有唯一的ID与它对应：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fuat5j1zfzj30zv086dgi.jpg" alt=""></p>
<p>接着，我们在小程序代码中可以插入生成的代码，如下是我在转发成功后的<code>success()</code>回掉函数中提交API上报。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">// 转发成功</span><br><span class="line">success: function (res) &#123;</span><br><span class="line">       wx.reportAnalytics(&apos;click_share&apos;, &#123;</span><br><span class="line">          page_path: current_page_path,</span><br><span class="line">          from: from,</span><br><span class="line">       &#125;);</span><br><span class="line">&#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>不管是填写配置还是API上报，都需要在填写完配置后保存并测试。</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fuat6s7eezj30o108ygme.jpg" alt=""></p>
<p><img src="https://ws4.sinaimg.cn/large/006tNbRwgy1fuat73bhhpj30o10el760.jpg" alt=""></p>
<p><img src="https://ws3.sinaimg.cn/large/006tNbRwgy1fuat7qug37j30o20dqdgf.jpg" alt=""></p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fuat81vmj9j30o00dqgm9.jpg" alt=""></p>
<p>我们在测试事件的时候，往往要过一段时间才能接收到数据，大概1-2分钟，为了能够及时判断正确性，我们可以在手机上的小程序应用中，打开调试，这样，每次触发事件时，都会在控制台的Log中看到<code>[自定义分析]上报成功的字样</code>，点击查看还能看到更多数据，比如上报的参数等，里面的<code>eventID</code>就对应事件的英文名称，可以通过这种方式快速判断事件触发是否符合预期，如下截图：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNbRwgy1fuatn0zeyrj30f50qywoz.jpg" alt=""></p>
<p>通过使用，我们发现小程序的自定义分析功能很强大，你可以在页面上分析任何元素、任何事件，使我们可以全方位的了解到小程序的使用情况，对数据加以分析总结，并以数据来驱动产品的迭代，提高用户留存。</p>
<p>参考：小程序官方文档 <a href="https://developers.weixin.qq.com/miniprogram/analysis/custom" target="_blank" rel="noopener">https://developers.weixin.qq.com/miniprogram/analysis/custom</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xydida.com/2018/8/15/小程序/WeChat-miniprogram-data-analysis-custom-analysis/" data-id="cjm257nvq000b289km3gaxnyw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/小程序/">小程序</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-The-Perfect-URL-Regular-Expression" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/8/11/Regular-Expression/The-Perfect-URL-Regular-Expression/" class="article-date">
  <time datetime="2018-08-11T04:33:30.000Z" itemprop="datePublished">2018-08-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/Regular-Expression/">Regular Expression</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/8/11/Regular-Expression/The-Perfect-URL-Regular-Expression/">部分语言URL正则匹配</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>开发中，经常会需要做一些正则匹配，比如手机号验证，email验证，URL匹配等，写此篇文章主要是记录如何使用正则表达式匹配URL，方便以后再遇到此问题时不必到处搜索而得不到满意的答案。</p>
<h2 id="PHP（使用preg-match"><a href="#PHP（使用preg-match" class="headerlink" title="PHP（使用preg_match)"></a>PHP（使用<a href="http://php.net/manual/en/function.preg-match.php" target="_blank" rel="noopener">preg_match</a>)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%^(?:(?:https?|ftp)://)(?:\S+(?::\S*)?@|\d&#123;1,3&#125;(?:\.\d&#123;1,3&#125;)&#123;3&#125;|(?:(?:[a-z\d\x&#123;00a1&#125;-\x&#123;ffff&#125;]+-?)*[a-z\d\x&#123;00a1&#125;-\x&#123;ffff&#125;]+)(?:\.(?:[a-z\d\x&#123;00a1&#125;-\x&#123;ffff&#125;]+-?)*[a-z\d\x&#123;00a1&#125;-\x&#123;ffff&#125;]+)*(?:\.[a-z\x&#123;00a1&#125;-\x&#123;ffff&#125;]&#123;2,6&#125;))(?::\d+)?(?:[^\s]*)?$%iu</span><br></pre></td></tr></table></figure>
<h2 id="PHP（使用validate-filter"><a href="#PHP（使用validate-filter" class="headerlink" title="PHP（使用validate filter)"></a>PHP（使用<a href="http://php.net/manual/en/filter.filters.validate.php" target="_blank" rel="noopener">validate filter</a>)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if (filter_var($url, FILTER_VALIDATE_URL) !== false)...</span><br></pre></td></tr></table></figure>
<h2 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http[s]?://(?:[a-zA-Z]|[0-9]|[$-_@.&amp;+]|[!*\(\),]|(?:%[0-9a-fA-F][0-9a-fA-F]))+</span><br></pre></td></tr></table></figure>
<h2 id="Javascript"><a href="#Javascript" class="headerlink" title="Javascript"></a>Javascript</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/((([A-Za-z]&#123;3,9&#125;:(?:\/\/)?)(?:[\-;:&amp;=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&amp;=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-_]*)?\??(?:[\-\+=&amp;;%@\.\w_]*)#?(?:[\.\!\/\\\w]*))?)/</span><br></pre></td></tr></table></figure>
<h2 id="HTML5"><a href="#HTML5" class="headerlink" title="HTML5"></a>HTML5</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;url&quot; /&gt;</span><br></pre></td></tr></table></figure>
<p>匹配上面<code>input</code>输入的URL（<a href="https://www.ietf.org/rfc/rfc3986.txt" target="_blank" rel="noopener">RFC3986</a>）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?</span><br></pre></td></tr></table></figure>
<h2 id="Perl"><a href="#Perl" class="headerlink" title="Perl"></a>Perl</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(((ht|f)tp(s?))\://)?(www.|[a-zA-Z].)[a-zA-Z0-9\-\.]+\.(com|edu|gov|mil|net|org|biz|info|name|museum|us|ca|uk)(\:[0-9]+)*(/($|[a-zA-Z0-9\.\,\;\?\&apos;\\\+&amp;%\$#\=~_\-]+))*$</span><br></pre></td></tr></table></figure>
<h2 id="Ruby"><a href="#Ruby" class="headerlink" title="Ruby"></a>Ruby</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/\A(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d&#123;1,3&#125;)&#123;3&#125;)(?!127(?:\.\d&#123;1,3&#125;)&#123;3&#125;)(?!169\.254(?:\.\d&#123;1,3&#125;)&#123;2&#125;)(?!192\.168(?:\.\d&#123;1,3&#125;)&#123;2&#125;)(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d&#123;1,3&#125;)&#123;2&#125;)(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d&#123;1,2&#125;|2[0-4]\d|25[0-5]))&#123;2&#125;(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]&#123;2,&#125;)))(?::\d&#123;2,5&#125;)?(?:\/[^\s]*)?\z/i</span><br></pre></td></tr></table></figure>
<h2 id="Go-使用govalidator-IsURL"><a href="#Go-使用govalidator-IsURL" class="headerlink" title="Go (使用govalidator.IsURL)"></a>Go (使用govalidator.IsURL)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">package main</span><br><span class="line"> import (</span><br><span class="line">         &quot;fmt&quot;</span><br><span class="line">         &quot;github.com/asaskevich/govalidator&quot;</span><br><span class="line"> )</span><br><span class="line"> func main() &#123;</span><br><span class="line">         str := &quot;http://www.urlregex.com&quot;</span><br><span class="line">         validURL := govalidator.IsURL(str)</span><br><span class="line">         fmt.Printf(&quot;%s is a valid URL : %v \n&quot;, str, validURL)</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Objective-C"><a href="#Objective-C" class="headerlink" title="Objective-C"></a>Objective-C</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(http|https)://((\\w)*|([0-9]*)|([-|_])*)+([\\.|/]((\\w)*|([0-9]*)|([-|_])*))+</span><br></pre></td></tr></table></figure>
<h2 id="Swift"><a href="#Swift" class="headerlink" title="Swift"></a>Swift</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((?:http|https)://)?(?:www\\.)?[\\w\\d\\-_]+\\.\\w&#123;2,3&#125;(\\.\\w&#123;2&#125;)?(/(?&lt;=/)(?:[\\w\\d\\-./_]+)?)?</span><br></pre></td></tr></table></figure>
<p>定义一个函数方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">func canOpenURL(string: String?) -&gt; Bool &#123;</span><br><span class="line">    let regEx = &quot;((https|http)://)((\\w|-)+)(([.]|[/])((\\w|-)+))+&quot;</span><br><span class="line">    let predicate = NSPredicate(format:&quot;SELF MATCHES %@&quot;, argumentArray:[regEx])</span><br><span class="line">    return predicate.evaluateWithObject(string)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if canOpenURL(&quot;http://www.urlregex.com&quot;) &#123;</span><br><span class="line">    print(&quot;valid url.&quot;)</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    print(&quot;invalid url.&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Swift-使用官方提供的canOpenURL"><a href="#Swift-使用官方提供的canOpenURL" class="headerlink" title="Swift (使用官方提供的canOpenURL)"></a>Swift (使用官方提供的<a href="https://developer.apple.com/documentation/uikit/uiapplication/1622952-canopenurl" target="_blank" rel="noopener">canOpenURL</a>)</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UIApplication.sharedApplication().canOpenURL(urlString)</span><br></pre></td></tr></table></figure>
<h2 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(https?|ftp|file)://[-a-zA-Z0-9+&amp;@#/%?=~_|!:,.;]*[-a-zA-Z0-9+&amp;@#/%=~_|]</span><br></pre></td></tr></table></figure>
<h2 id="VB-NET"><a href="#VB-NET" class="headerlink" title="VB.NET"></a>VB.NET</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(http(s)?://)?([\w-]+\.)+[\w-]+[.com]+(/[/?%&amp;=]*)?</span><br></pre></td></tr></table></figure>
<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^(ht|f)tp(s?)\:\/\/[0-9a-zA-Z]([-.\w]*[0-9a-zA-Z])*(:(0-9)*)*(\/?)([a-zA-Z0-9\-\.\?\,\&apos;\/\\\+&amp;%\$#_]*)?$</span><br></pre></td></tr></table></figure>
<h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">SELECT field FROM table </span><br><span class="line">WHERE field </span><br><span class="line">REGEXP &quot;^(https?://|www\\.)[\.A-Za-z0-9\-]+\\.[a-zA-Z]&#123;2,4&#125;</span><br></pre></td></tr></table></figure>
<p>整理自：<a href="http://urlregex.com" target="_blank" rel="noopener">http://urlregex.com</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xydida.com/2018/8/11/Regular-Expression/The-Perfect-URL-Regular-Expression/" data-id="cjm257nvl0006289k5zgwcq89" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/">C#</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Go/">Go</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Javascript/">Javascript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Objective-C/">Objective-C</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Perl/">Perl</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Python/">Python</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Swift/">Swift</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/VB-NET/">VB.NET</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-why-htmlspecialchars-returns-null-in-PHP" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/6/18/PHP/why-htmlspecialchars-returns-null-in-PHP/" class="article-date">
  <time datetime="2018-06-18T15:08:01.000Z" itemprop="datePublished">2018-06-18</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/6/18/PHP/why-htmlspecialchars-returns-null-in-PHP/">解决PHP中htmlspecialchars返回null的问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在开发中，经常需要对用户传过来的数据进行过滤，来阻止一些用户的恶意输入，在PHP中常用到<code>htmlspecialchars()</code>、<code>htmlentities()</code>和<code>strip_tags()</code>函数来处理。</p>
<p>今天在使用<code>htmlspecialchars()</code>做特殊字符的转换时，一直返回<code>null</code>，当我换成<code>htmlentities()</code>也是同样的问题，查官方手册才发现原来是编码的问题。</p>
<p>函数声明：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fsg8j0lpb8j30oj01r3yx.jpg" alt=""></p>
<p>问题主要处在第三个参数上，对于第三个参数官方是这么说的：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fsg8jbqp36j30sq05tmyn.jpg" alt=""></p>
<p>这个参数的作用是设置转换字符时采用的编码，在PHP 5.4 和5.5中使用了<strong>UTF-8</strong>作为默认编码，而在PHP 5.4之前使用<strong>ISO-8859-1</strong>作为默认编码，从PHP 5.6开始就使用PHP配置文件中的<code>default_charset</code>参数作为默认编码。<code>encoding</code>参数支持的字符集：</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fsg8jl4onxj30r80ir0xa.jpg" alt=""></p>
<p>从PHP的更新日志也能看到这个参数的变化：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fsg8js1l1aj30sk05jab6.jpg" alt=""></p>
<p>一般我们是这么使用的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$str=&apos;&lt;a href=&quot;test.html&quot;&gt;\&apos;测试页面\&apos;&lt;/a&gt;&lt;script&gt;alert(213)&lt;/script&gt;&apos;;</span><br><span class="line">echo htmlspecialchars($str);</span><br><span class="line">// 输出：&amp;lt;a href=&amp;quot;test.html&amp;quot;&amp;gt;&apos;测试页面&apos;&amp;lt;/a&amp;gt;&amp;lt;script&amp;gt;alert(213)&amp;lt;/script&amp;gt;</span><br></pre></td></tr></table></figure>
<p>今天在使用的时候，结果一直返回null，其实就是编码的问题，这个时候就需要用到第三个参数了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo htmlspecialchars($string, ENT_COMPAT,&apos;ISO-8859-1&apos;, true);</span><br></pre></td></tr></table></figure>
<p>同样，也适用于<code>htmlentities</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo htmlentities($string, ENT_COMPAT,&apos;ISO-8859-1&apos;, true);</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://xydida.com/2018/6/18/PHP/why-htmlspecialchars-returns-null-in-PHP/" data-id="cjm257nvz000m289k35caeegj" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Learn-MySQL-indexes" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/6/6/MySQL/Learn-MySQL-indexes/" class="article-date">
  <time datetime="2018-06-06T11:10:04.000Z" itemprop="datePublished">2018-06-06</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/MySQL/">MySQL</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/6/6/MySQL/Learn-MySQL-indexes/">MySQL中的索引学习</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fs2f97s3m4j31kw16o1kz.jpg" alt=""></p>
<h1 id="什么是索引？"><a href="#什么是索引？" class="headerlink" title="什么是索引？"></a>什么是索引？</h1><p>在没有学数据库之前，大多数人对索引还是比较陌生（可能学完之后还是比较陌生：），今天我想告诉大家索引很有用，而且面试的时候都会问到。那么索引是什么呢？</p>
<p>其实索引这个东西我们很早就接触过了，想象一下当初学习《现代汉语词典》的时候，老师是如何教我们使用的，就可以理解什么是索引了。《现代汉语词典》有将近1800页，里面的汉字大概有1.3万多个，我们是如何在这么多的汉字中找到某个字呢？老师大概是这么教我们的：词典提供了“音节表”，“音节表”将所有汉子的汉语拼音编入其中，并且“音节表”按’a’到’z’的顺序排序，故而我们可以轻松的在音节表中找到某个字所对应的页数。其实不光是词典，我们看的书大部分都有目录，而这个目录就相当于索引的作用，如下是三本书的目录：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fs1onskl51j31kw23vx6p.jpg" alt="《禅与摩托车维修艺术》的目录"></p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fs1opioucuj31kw23vu0y.jpg" alt="《黑客与画家》的目录"></p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fs1oq9j6zuj31kw23vx6q.jpg" alt="《计算机程序的构造和解释》的目录"></p>
<p>通过上面三本书的目录的对比，很明显第一本书的目录写的很简单，第二本书稍详细一点，而第三本书的目录最详细，目录写得越详细，读者在阅读的时候就越方便。</p>
<p>不管是词典中的音节表还是书的目录，它们实际都是索引的一种存在形式，都是为了能够提高查找的效率。</p>
<h2 id="数据库中索引的本质"><a href="#数据库中索引的本质" class="headerlink" title="数据库中索引的本质"></a>数据库中索引的本质</h2><p>本质上，索引其实是数据库表中字段值的复制，该字段称为索引的关键字。</p>
<h2 id="索引在计算机中的存储"><a href="#索引在计算机中的存储" class="headerlink" title="索引在计算机中的存储"></a>索引在计算机中的存储</h2><p>在学习数据结构时，曾讲到文件的概念，而数据库中所有的数据都是以文件的形式保存的计算机中的，所以文件系统是数据库系统的基础。而数据库在操作这些文件时，都是先将文件中的数据加载到内存，然后再以某种数据结构来操作这些数据，通常的数据结构可以是<a href="http://lib.csdn.net/article/datastructure/9204" target="_blank" rel="noopener">AVL树</a>、<a href="https://blog.csdn.net/v_july_v/article/details/6530142" target="_blank" rel="noopener">B树</a>、<a href="https://blog.csdn.net/v_july_v/article/details/6530142" target="_blank" rel="noopener">B+树</a>等。数据库中的往往是要存大量的数据的，而所有的数据不可能一次性全部加载到内存中，这时候就需要索引与分块加载来提高查询的速度，不过一般初学者不会体验到索引带来的高效，因为他们的电脑内存足够大完全可以一次性加载完所有数据，这也导致初学者忽略了对索引的仔细学习。如下是MyISAM存储引擎的索引示意图：</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fs1qj978vfj30qe0cigms.jpg" alt="MyISAM存储引擎teacher表的主索引及普通索引"></p>
<p>更多关于数据库索引背后的数据结构和算法原理，请查看：<a href="https://www.cnblogs.com/tgycoder/p/5410057.html" target="_blank" rel="noopener">https://www.cnblogs.com/tgycoder/p/5410057.html</a></p>
<h1 id="MySQL中的索引"><a href="#MySQL中的索引" class="headerlink" title="MySQL中的索引"></a>MySQL中的索引</h1><p>在MySQL中，共有4类索引：主键索引、唯一索引、常规索引和全文索引。</p>
<h2 id="主键索引-Primary-key"><a href="#主键索引-Primary-key" class="headerlink" title="主键索引(Primary key)"></a>主键索引(Primary key)</h2><p>主键索引是关系数据库中最常见的索引类型。它根据主键自身的唯一性来唯一标识每条记录。因此该键必须是表中的唯一值。创建主键索引很简单，如下：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fs1r9yjm69j30mi06kgnw.jpg" alt=""></p>
<p>每个表只能有一个自增字段，该字段必须指定为主键。此外，任何指定为主键的字段不能是NULL，即使没有声明为NOT NULL，MySQL会自己设置。</p>
<h2 id="唯一索引-Unique"><a href="#唯一索引-Unique" class="headerlink" title="唯一索引(Unique)"></a>唯一索引(Unique)</h2><p>与主键索引一样，唯一索引可以防止创建重复的值。不同之处在于每个表只能有一个主键索引，但可以有多个唯一索引。修改上面的sql语句来增加唯一索引：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fs1sopkc84j30la068ac3.jpg" alt=""></p>
<p>如前面所讲，表中可以指定多个唯一字段，我们现在将<code>name</code>字段也设置为唯一：</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fs1sqt9824j30l206iwgr.jpg" alt=""></p>
<p>还可以指定多列唯一索引，比如上面的表结构中，允许用户插入重复的url，甚至可以插入重复的name值，但不希望出现重复的name和url的组合。可以创建多列唯一索引来强制这种约束，如下：</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fs1suh963uj30m207oacm.jpg" alt=""></p>
<h2 id="常规索引-Index"><a href="#常规索引-Index" class="headerlink" title="常规索引(Index)"></a>常规索引(Index)</h2><p>可能经常需要对数据库的搜索效率进行优化，以便能够根据并非主键甚至并非唯一的列获取数据行。为此，最有效的方法是采用某种方式索引列，是的数据库尽可能快的查找想要的值。这就称为常规索引。</p>
<h3 id="单列常规索引"><a href="#单列常规索引" class="headerlink" title="单列常规索引"></a>单列常规索引</h3><p>如果表中的某个列经常需要被查询到，就应该使用单列常规索引。假如，一张员工表you 4列：主键id，名字，姓氏和电子邮箱，若果大多数的查询操作都会针对员工的姓氏或者电子邮箱，因为员工的姓氏可以有重复的，而电子邮箱必须唯一，我们就可以给姓氏创建一个常规索引，电子邮箱创建一个唯一索引，如下：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fs2e082sw6j30lu07edif.jpg" alt=""></p>
<p>同时，MySQL还提供了创建局部字段索引的特性，方式是：将某一字段的前N的字符作为索引，相比于单列常规索引，局部索引需要更少的磁盘空间，同时由于索引的数据短，因此效率会高一点。修改前面的示例，因为通常lastname的前5个字符就足以确保获取到唯一的数据，修改如下：</p>
<p><img src="https://ws3.sinaimg.cn/large/006tNc79gy1fs2e0s2v9ij30lu07edif.jpg" alt=""></p>
<h3 id="多列常规索引"><a href="#多列常规索引" class="headerlink" title="多列常规索引"></a>多列常规索引</h3><p>一般查询时，通常需要包含多列，我们可以指定一些经常被查询的列为多列常规索引。MySQL的多列常规索引方法基于一种<a href="https://www.zhihu.com/question/36996520" target="_blank" rel="noopener">最左前缀(leftmost prefixing)</a>的策略。最左前缀指出包含列A、B和C的任何多列索引都可以提高涉及如下列组合的查询的性能：</p>
<ul>
<li>A、B、C</li>
<li>A、B</li>
<li>A</li>
</ul>
<p>创建多列索引：</p>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fs2e0z82f0j30km07cmzr.jpg" alt=""></p>
<p>上图中创建了三个索引，第一个是主键索引，第二个是电子邮箱的唯一索引，第三个就是多列索引，包括两列：lastname和firstname。</p>
<h3 id="全文索引"><a href="#全文索引" class="headerlink" title="全文索引"></a>全文索引</h3><p>当字段类型为char、varchar或text时，我们可以使用全文索引。在MySQL中，对大量自然语言做全文搜索时，它提供了一种数据获取的机制，并生成最符合用户需要的结果。比如在对这样“Nginx is the world’s most popular web server”的字符串进行搜索时，单词is和the对结果几乎起不了任何作用，MySQL在搜索时，将文本分解为单词，默认忽略少于4个字符的单词。创建全文索引：</p>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fs2e17ph34j30ku07ajtu.jpg" alt=""></p>
<p>创建全文索引的方式与创建其他索引没什么区别，但基于全文索引的查询却有一点不同。在查询时，select语句需要使用两个特殊的MySQL函数<code>match()</code>和<code>againet()</code>。查询方式如下：</p>
<p><img src="https://ws2.sinaimg.cn/large/006tNc79gy1fs2e1enqvrj314c010mxp.jpg" alt=""></p>
<h4 id="Boolean全文搜索"><a href="#Boolean全文搜索" class="headerlink" title="Boolean全文搜索"></a>Boolean全文搜索</h4><p>Boolean全文搜索对查询提供了更加细的控制允许显示地标识候选结果中应当或不应当出现哪些词（MySQL默认会忽略少于4个字符的关键词）。以下是关于Boolean操作符的描述：</p>
<p>+ 前导加号确保后面的单词出现在每个结果记录中<br>- 前导减号确保后面的单词不出现在任何结果记录中<br>* 结尾处的星号允许接受关键字变体，只要该变体以星号前面的单词所制定的字符串开头<br>“ “ 外围的双引号确保结果记录包含所包围的字符串，要严格按照输入时的形式出现<br>&lt; &gt; 前导的大于号和小于号分别用于增加和减少后面单词的搜索级别相关度<br>( ) 小括号用于将单词分组为子表达式</p>
<p>如下是几个简单的例子：</p>
<ol>
<li>返回包含Nginx，但不包含manual的记录：</li>
</ol>
<p><img src="https://ws4.sinaimg.cn/large/006tNc79gy1fs2e7333k8j30tw01yt98.jpg" alt=""></p>
<ol start="2">
<li>返回包含单词Nginx，但不包含Apache或Tomcat的记录：</li>
</ol>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fs2e9gd0sqj30t201wwf2.jpg" alt=""></p>
<ol start="3">
<li>返回包含web和scripting或者php和scripting的记录，但web scripting的搜索级别低于php scripting：</li>
</ol>
<p><img src="https://ws1.sinaimg.cn/large/006tNc79gy1fs2ecup96cj30t00220t8.jpg" alt=""></p>
<p>注意，由于MySQL默认会忽略少于4个字符的单词，所以执行上面的SQL命令时，应该先修改<code>ft_min_word_len</code>参数。</p>
<h1 id="索引选取的注意事项"><a href="#索引选取的注意事项" class="headerlink" title="索引选取的注意事项"></a>索引选取的注意事项</h1><ol>
<li>只对<code>WHERE</code>和<code>ORDER BY</code>子句中需要的列添加索引，过多的索引会占用很多硬盘空间，在修改数据时还会降低性能，因为每次修改数据时都需要更新索引。</li>
<li>如果创建如<code>INDEX(firstname, lastname)</code>的索引时，不要再创建<code>INDEX(firstname)</code>，因为MySQL的索引采用最左前缀策略。</li>
<li>需要索引的列要不为空（NOT NULL），保证构建索引时不存储NULL值。</li>
<li>可以开启慢查询日志，通过对慢查询日志的分析来优化索引。</li>
</ol>
<p>参考：<br>《PHP与MySQL程序设计（第四版）》</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://xydida.com/2018/6/6/MySQL/Learn-MySQL-indexes/" data-id="cjm257nws0027289k6x9e0la5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/MySQL/">MySQL</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Algorithm/">Algorithm</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Devops/">Devops</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Networks/">Networks</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Object-Oriented/">Object Oriented</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Regular-Expression/">Regular Expression</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/frontend/">frontend</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/notes/">notes</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/小程序/">小程序</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/">C#</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Go/">Go</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/">Java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/">Javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Object-Oriented/">Object Oriented</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Objective-C/">Objective-C</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PSR/">PSR</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Perl/">Perl</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby/">Ruby</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SICP/">SICP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Server/">Server</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Something/">Something</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swift/">Swift</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VB-NET/">VB.NET</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/autoload/">autoload</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/interviews/">interviews</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/networks/">networks</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/routing/">routing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小程序/">小程序</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 10px;">C#</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/Go/" style="font-size: 10px;">Go</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Javascript/" style="font-size: 10px;">Javascript</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MySQL/" style="font-size: 15px;">MySQL</a> <a href="/tags/Object-Oriented/" style="font-size: 10px;">Object Oriented</a> <a href="/tags/Objective-C/" style="font-size: 10px;">Objective-C</a> <a href="/tags/PHP/" style="font-size: 20px;">PHP</a> <a href="/tags/PSR/" style="font-size: 10px;">PSR</a> <a href="/tags/Perl/" style="font-size: 10px;">Perl</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/Ruby/" style="font-size: 10px;">Ruby</a> <a href="/tags/SICP/" style="font-size: 10px;">SICP</a> <a href="/tags/Server/" style="font-size: 15px;">Server</a> <a href="/tags/Something/" style="font-size: 10px;">Something</a> <a href="/tags/Swift/" style="font-size: 10px;">Swift</a> <a href="/tags/VB-NET/" style="font-size: 10px;">VB.NET</a> <a href="/tags/autoload/" style="font-size: 10px;">autoload</a> <a href="/tags/canvas/" style="font-size: 10px;">canvas</a> <a href="/tags/interviews/" style="font-size: 10px;">interviews</a> <a href="/tags/networks/" style="font-size: 10px;">networks</a> <a href="/tags/routing/" style="font-size: 10px;">routing</a> <a href="/tags/小程序/" style="font-size: 15px;">小程序</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">June 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">February 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/9/14/小程序/The-measureText-function-in-Wechat-miniprogram-canvas/">在小程序Canvas中使用measureText</a>
          </li>
        
          <li>
            <a href="/2018/8/15/小程序/WeChat-miniprogram-data-analysis-custom-analysis/">微信小程序数据分析之自定义分析</a>
          </li>
        
          <li>
            <a href="/2018/8/11/Regular-Expression/The-Perfect-URL-Regular-Expression/">部分语言URL正则匹配</a>
          </li>
        
          <li>
            <a href="/2018/6/18/PHP/why-htmlspecialchars-returns-null-in-PHP/">解决PHP中htmlspecialchars返回null的问题</a>
          </li>
        
          <li>
            <a href="/2018/6/6/MySQL/Learn-MySQL-indexes/">MySQL中的索引学习</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Bilberry<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>